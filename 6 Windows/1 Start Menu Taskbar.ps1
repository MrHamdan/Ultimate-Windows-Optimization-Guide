    If (!([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]"Administrator"))
    {Start-Process PowerShell.exe -ArgumentList ("-NoProfile -ExecutionPolicy Bypass -File `"{0}`"" -f $PSCommandPath) -Verb RunAs
    Exit}
    $Host.UI.RawUI.WindowTitle = $myInvocation.MyCommand.Definition + " (Administrator)"
    $Host.UI.RawUI.BackgroundColor = "Black"
	$Host.PrivateData.ProgressBackgroundColor = "Black"
    $Host.PrivateData.ProgressForegroundColor = "White"
    Clear-Host

    function Get-FileFromWeb {
    param ([Parameter(Mandatory)][string]$URL, [Parameter(Mandatory)][string]$File)
    function Show-Progress {
    param ([Parameter(Mandatory)][Single]$TotalValue, [Parameter(Mandatory)][Single]$CurrentValue, [Parameter(Mandatory)][string]$ProgressText, [Parameter()][int]$BarSize = 10, [Parameter()][switch]$Complete)
    $percent = $CurrentValue / $TotalValue
    $percentComplete = $percent * 100
    if ($psISE) { Write-Progress "$ProgressText" -id 0 -percentComplete $percentComplete }
    else { Write-Host -NoNewLine "`r$ProgressText $(''.PadRight($BarSize * $percent, [char]9608).PadRight($BarSize, [char]9617)) $($percentComplete.ToString('##0.00').PadLeft(6)) % " }
    }
    try {
    $request = [System.Net.HttpWebRequest]::Create($URL)
    $response = $request.GetResponse()
    if ($response.StatusCode -eq 401 -or $response.StatusCode -eq 403 -or $response.StatusCode -eq 404) { throw "Remote file either doesn't exist, is unauthorized, or is forbidden for '$URL'." }
    if ($File -match '^\.\\') { $File = Join-Path (Get-Location -PSProvider 'FileSystem') ($File -Split '^\.')[1] }
    if ($File -and !(Split-Path $File)) { $File = Join-Path (Get-Location -PSProvider 'FileSystem') $File }
    if ($File) { $fileDirectory = $([System.IO.Path]::GetDirectoryName($File)); if (!(Test-Path($fileDirectory))) { [System.IO.Directory]::CreateDirectory($fileDirectory) | Out-Null } }
    [long]$fullSize = $response.ContentLength
    [byte[]]$buffer = new-object byte[] 1048576
    [long]$total = [long]$count = 0
    $reader = $response.GetResponseStream()
    $writer = new-object System.IO.FileStream $File, 'Create'
    do {
    $count = $reader.Read($buffer, 0, $buffer.Length)
    $writer.Write($buffer, 0, $count)
    $total += $count
    if ($fullSize -gt 0) { Show-Progress -TotalValue $fullSize -CurrentValue $total -ProgressText " $($File.Name)" }
    } while ($count -gt 0)
    }
    finally {
    $reader.Close()
    $writer.Close()
    }
    }

    Write-Host "1. Start Menu Taskbar: Clean (Recommended)"
    Write-Host "2. Start Menu Taskbar: Default"
    while ($true) {
    $choice = Read-Host " "
    if ($choice -match '^[1-2]$') {
    switch ($choice) {
    1 {

Clear-Host
Write-Host "Start Menu Taskbar: Clean . . ."
# CLEAN TASKBAR
# unpin all taskbar icons
cmd /c "reg delete HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband /f >nul 2>&1"
Remove-Item -Recurse -Force "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch" -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer" -Name "Quick Launch" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch" -Name "User Pinned" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned" -Name "TaskBar" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned" -Name "ImplicitAppShortcuts" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
# pin file explorer to taskbar
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:AppData\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar\File Explorer.lnk")
$Shortcut.TargetPath = "explorer"
$Shortcut.Save()
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "Favorites" /t REG_BINARY /d "00aa0100003a001f80c827341f105c1042aa032ee45287d668260001002600efbe10000000f47e76fade9dda0140615d09df9dda0119b85f09df9dda0114005600310000000000a458a92610005461736b42617200400009000400efbea458a926a458a9262e000000de9c01000000020000000000000000000000000000000cf485005400610073006b0042006100720000001600180132008a040000a458b626200046494c4545587e312e4c4e4b0000540009000400efbea458b626a458b6262e000000b7a80100000004000000000000000000000000000000c05a1e01460069006c00650020004500780070006c006f007200650072002e006c006e006b0000001c00220000001e00efbe02005500730065007200500069006e006e006500640000001c00120000002b00efbe19b85f09df9dda011c00740000001d00efbe02007b00460033003800420046003400300034002d0031004400340033002d0034003200460032002d0039003300300035002d003600370044004500300042003200380046004300320033007d005c006500780070006c006f007200650072002e0065007800650000001c000000ff" /f | Out-Null
# remove windows widgets from taskbar
reg add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v "AllowNewsAndInterests" /t REG_DWORD /d "0" /f | Out-Null
# left taskbar alignment
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAl" /t REG_DWORD /d "0" /f | Out-Null
# remove search from taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "SearchboxTaskbarMode" /t REG_DWORD /d "0" /f | Out-Null
# remove task view from taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d "0" /f | Out-Null
# remove chat from taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarMn" /t REG_DWORD /d "0" /f | Out-Null
# remove copilot from taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowCopilotButton" /t REG_DWORD /d "0" /f | Out-Null
# remove news and interests
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v "EnableFeeds" /t REG_DWORD /d "0" /f | Out-Null
# remove meet now
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "HideSCAMeetNow" /t REG_DWORD /d "1" /f | Out-Null
# remove security taskbar icon
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "SecurityHealth" /t REG_BINARY /d "0700000005DB8A698A49D901" /f | Out-Null
# remove action center
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /t REG_DWORD /d "1" /f | Out-Null
# show all taskbar icons w10 only
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer" /v "EnableAutoTray" /t REG_DWORD /d "0" /f | Out-Null
# CLEAN START MENU W11
$progresspreference = 'silentlycontinue'
Remove-Item -Recurse -Force "$env:USERPROFILE\AppData\Local\Packages\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\LocalState\start2.bin" -ErrorAction SilentlyContinue
Get-FileFromWeb -URL "https://github.com/fr33thytweaks/files/raw/main/start2.bin" -File "$env:USERPROFILE\AppData\Local\Packages\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\LocalState\start2.bin"
# CLEAN START MENU W10
# delete startmenulayout.xml
Remove-Item -Recurse -Force "$env:C:\Windows\StartMenuLayout.xml" -ErrorAction SilentlyContinue | Out-Null
# create startmenulayout.xml
$MultilineComment = @"
<LayoutModificationTemplate xmlns:defaultlayout="http://schemas.microsoft.com/Start/2014/FullDefaultLayout" xmlns:start="http://schemas.microsoft.com/Start/2014/StartLayout" Version="1" xmlns:taskbar="http://schemas.microsoft.com/Start/2014/TaskbarLayout" xmlns="http://schemas.microsoft.com/Start/2014/LayoutModification">
    <LayoutOptions StartTileGroupCellWidth="6" />
    <DefaultLayoutOverride>
        <StartLayoutCollection>
            <defaultlayout:StartLayout GroupCellWidth="6" />
        </StartLayoutCollection>
    </DefaultLayoutOverride>
</LayoutModificationTemplate>
"@
Set-Content -Path "C:\Windows\StartMenuLayout.xml" -Value $MultilineComment -Force -Encoding ASCII
# assign startmenulayout.xml registry
$layoutFile="C:\Windows\StartMenuLayout.xml"
$regAliases = @("HKLM", "HKCU")
foreach ($regAlias in $regAliases){
$basePath = $regAlias + ":\SOFTWARE\Policies\Microsoft\Windows"
$keyPath = $basePath + "\Explorer"
IF(!(Test-Path -Path $keyPath)) {
New-Item -Path $basePath -Name "Explorer" | Out-Null
}
Set-ItemProperty -Path $keyPath -Name "LockedStartLayout" -Value 1 | Out-Null
Set-ItemProperty -Path $keyPath -Name "StartLayoutFile" -Value $layoutFile | Out-Null
}
# restart explorer
Stop-Process -Force -Name explorer -ErrorAction SilentlyContinue | Out-Null
Timeout /T 5 | Out-Null
# disable lockedstartlayout registry
foreach ($regAlias in $regAliases){
$basePath = $regAlias + ":\SOFTWARE\Policies\Microsoft\Windows"
$keyPath = $basePath + "\Explorer"
Set-ItemProperty -Path $keyPath -Name "LockedStartLayout" -Value 0
}
# restart explorer
Stop-Process -Force -Name explorer -ErrorAction SilentlyContinue | Out-Null
# delete startmenulayout.xml
Remove-Item -Recurse -Force "$env:C:\Windows\StartMenuLayout.xml" -ErrorAction SilentlyContinue | Out-Null
Clear-Host
Write-Host "Restart to apply . . ."
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
exit

      }
    2 {

Clear-Host
Write-Host "Start Menu Taskbar: Default . . ."
# TASKBAR
# unpin all taskbar icons
cmd /c "reg delete HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband /f >nul 2>&1"
Remove-Item -Recurse -Force "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch" -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer" -Name "Quick Launch" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch" -Name "User Pinned" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned" -Name "TaskBar" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
New-Item -Path "$env:USERPROFILE\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned" -Name "ImplicitAppShortcuts" -ItemType Directory -ErrorAction SilentlyContinue | Out-Null
# pin file explorer to taskbar
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:AppData\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar\File Explorer.lnk")
$Shortcut.TargetPath = "explorer"
$Shortcut.Save()
# pin microsoft edge to taskbar
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:AppData\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar\Microsoft Edge.lnk")
$Shortcut.TargetPath = "$env:C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"     
$Shortcut.Save()
# pin microsoft edge to taskbar
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:AppData\Microsoft\Internet Explorer\Quick Launch\Microsoft Edge.lnk")
$Shortcut.TargetPath = "$env:C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"     
$Shortcut.Save()
# pin show desktop to taskbar
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:AppData\Microsoft\Internet Explorer\Quick Launch\Show desktop.lnk")
$Shortcut.TargetPath = "shell:::{3080F90D-D7AD-11D9-BD98-0000947B0257}"
$Shortcut.Save()
# pin switch between windows to taskbar
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:AppData\Microsoft\Internet Explorer\Quick Launch\Switch between windows.lnk")
$Shortcut.TargetPath = "shell:::{3080F90E-D7AD-11D9-BD98-0000947B0257}"
$Shortcut.Save()
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "FavoritesResolve" /t REG_BINARY /d "e40200004c0000000114020000000000c0000000000000468300800020000000de32c463b19ada01de32c463b19ada01fb8ce03bb09ada0186090000000000000100000000000000000000000000000052013a001f80c827341f105c1042aa032ee45287d668260001002600efbe12000000ee082d3cb19ada01de32c463b19ada01de32c463b19ada01140056003100000000009e582c1e10005461736b42617200400009000400efbe9e582c1e9e582c1e2e00000069a10100000001000000000000000000000000000000224753005400610073006b0042006100720000001600c0003200860900009e58241d20004d4943524f537e312e4c4e4b0000560009000400efbe9e582c1e9e582c1e2e0000006aa10100000001000000000000000000000000000000055593004d006900630072006f0073006f0066007400200045006400670065002e006c006e006b0000001c00220000001e00efbe02005500730065007200500069006e006e006500640000001c00120000002b00efbede32c463b19ada011c001a0000001d00efbe02004d005300450064006700650000001c0000009b0000001c000000010000001c0000002d000000000000009a00000011000000030000008fcb5d8e1000000000433a5c55736572735c5731305c417070446174615c526f616d696e675c4d6963726f736f66745c496e7465726e6574204578706c6f7265725c517569636b204c61756e63685c557365722050696e6e65645c5461736b4261725c4d6963726f736f667420456467652e6c6e6b000060000000030000a058000000000000006465736b746f702d37376c6732363800cc3c4d6a1da8234f9fc341f4f3a33b462cb01091a306ef11a5fd000c29afc6c9cc3c4d6a1da8234f9fc341f4f3a33b462cb01091a306ef11a5fd000c29afc6c945000000090000a03900000031535053b1166d44ad8d7048a748402ea43d788c1d000000680000000048000000ea11e54dbc6c6b41a1aa683a11f5c00c000000000000000000000000310300004c0000000114020000000000c000000000000046830080002000000021a7c663b19ada01aaf6c863b19ada01a8b6c6daddacd501970100000000000001000000000000000000000000000000a0013a001f80c827341f105c1042aa032ee45287d668260001002600efbe12000000ee082d3cb19ada01de32c463b19ada01aaf6c863b19ada01140056003100000000009e582c1e11005461736b42617200400009000400efbe9e582c1e9e582c1e2e00000069a1010000000100000000000000000000000000000056834e005400610073006b00420061007200000016000e01320097010000874f0749200046494c4545587e312e4c4e4b00007c0009000400efbe9e582c1e9e582c1e2e0000006ba10100000001000000000000000000520000000000589c4400460069006c00650020004500780070006c006f007200650072002e006c006e006b00000040007300680065006c006c00330032002e0064006c006c002c002d003200320030003600370000001c00220000001e00efbe02005500730065007200500069006e006e006500640000001c00120000002b00efbeaaf6c863b19ada011c00420000001d00efbe02004d006900630072006f0073006f00660074002e00570069006e0064006f00770073002e004500780070006c006f0072006500720000001c0000009a0000001c000000010000001c0000002d000000000000009900000011000000030000008fcb5d8e1000000000433a5c55736572735c5731305c417070446174615c526f616d696e675c4d6963726f736f66745c496e7465726e6574204578706c6f7265725c517569636b204c61756e63685c557365722050696e6e65645c5461736b4261725c46696c65204578706c6f7265722e6c6e6b000060000000030000a058000000000000006465736b746f702d37376c6732363800cc3c4d6a1da8234f9fc341f4f3a33b4632b01091a306ef11a5fd000c29afc6c9cc3c4d6a1da8234f9fc341f4f3a33b4632b01091a306ef11a5fd000c29afc6c945000000090000a03900000031535053b1166d44ad8d7048a748402ea43d788c1d000000680000000048000000ea11e54dbc6c6b41a1aa683a11f5c00c000000000000000000000000990600004c0000000114020000000000c0000000000000468100800000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000470614001f809bd434424502f34db7803893943456e1310600009905415050538705080003000000000000004e0200003153505355284c9f799f394ba8d0e1d42de1d5f35d00000011000000001f000000250000004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f003800770065006b0079006200330064003800620062007700650000000000110000000e0000000013000000010000008500000015000000001f000000390000004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f00310031003900310030002e0031003000300032002e0035002e0030005f007800360034005f005f003800770065006b00790062003300640038006200620077006500000000006500000005000000001f000000290000004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f003800770065006b00790062003300640038006200620077006500210041007000700000000000bd0000000f000000001f0000005600000043003a005c00500072006f006700720061006d002000460069006c00650073005c00570069006e0064006f007700730041007000700073005c004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f00310031003900310030002e0031003000300032002e0035002e0030005f007800360034005f005f003800770065006b0079006200330064003800620062007700650000001d00000020000000004800000005c572a5af325c4ea556c4940b8a77a1000000008a020000315350534d0bd48669903c44819a2a54090dccec550000000c000000001f000000210000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065004d0065006400540069006c0065002e0070006e006700000000005500000002000000001f000000210000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065004100700070004c006900730074002e0070006e00670000000000590000000f000000001f000000230000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f0072006500420061006400670065004c006f0067006f002e0070006e00670000000000550000000d000000001f000000220000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065005700690064006500540069006c0065002e0070006e0067000000110000000400000000130000000078d7ff5900000013000000001f000000230000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065004c006100720067006500540069006c0065002e0070006e0067000000000011000000050000000013000000ffffffff110000000e0000000013000000a5040000310000000b000000001f000000100000004d006900630072006f0073006f00660074002000530074006f007200650000005900000014000000001f000000230000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f007200650053006d0061006c006c00540069006c0065002e0070006e00670000000000000000003100000031535053b1166d44ad8d7048a748402ea43d788c150000006400000000150000001401000000000000000000004d0000003153505330f125b7ef471a10a5f102608c9eebac310000000a000000001f000000100000004d006900630072006f0073006f00660074002000530074006f00720065000000000000002d00000031535053b377ed0d14c66c45ae5b285b38d7b01b110000000700000000130000000000000000000000000000000000220000001e00efbe02005500730065007200500069006e006e006500640000009f05120000002b00efbec858cb63b19ada019f055e0000001d00efbe02004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f003800770065006b00790062003300640038006200620077006500210041007000700000009f05000000000000010700004c0000000114020000000000c0000000000000468100800000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000af0614001f809bd434424502f34db7803893943456e199060000b50541505053a30508000300000000000000f60200003153505355284c9f799f394ba8d0e1d42de1d5f37500000011000000001f000000320000006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f003800770065006b007900620033006400380062006200770065000000110000000e000000001300000001000000a900000015000000001f0000004b0000006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f00310036003000300035002e00310031003600320039002e00320030003300310036002e0030005f007800360034005f005f003800770065006b0079006200330064003800620062007700650000000000ad00000005000000001f0000004d0000006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f003800770065006b0079006200330064003800620062007700650021006d006900630072006f0073006f00660074002e00770069006e0064006f00770073006c006900760065002e006d00610069006c0000000000e10000000f000000001f0000006800000043003a005c00500072006f006700720061006d002000460069006c00650073005c00570069006e0064006f007700730041007000700073005c006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f00310036003000300035002e00310031003600320039002e00320030003300310036002e0030005f007800360034005f005f003800770065006b0079006200330064003800620062007700650000001d000000200000000048000000a0078866edfc3449881d9db73548d33c0000000012020000315350534d0bd48669903c44819a2a54090dccec490000000c000000001f0000001c00000069006d0061006700650073005c00480078004d00610069006c004d0065006400690075006d00540069006c0065002e0070006e00670000004500000002000000001f0000001900000069006d0061006700650073005c00480078004d00610069006c004100700070004c006900730074002e0070006e00670000000000410000000f000000001f0000001700000069006d0061006700650073005c00480078004d00610069006c00420061006400670065002e0070006e00670000000000450000000d000000001f0000001a00000069006d0061006700650073005c00480078004d00610069006c005700690064006500540069006c0065002e0070006e0067000000110000000400000000130000000078d7ff4900000013000000001f0000001b00000069006d0061006700650073005c00480078004d00610069006c004c006100720067006500540069006c0065002e0070006e0067000000000011000000050000000013000000ffffffff110000000e0000000013000000ad0400001d0000000b000000001f000000050000004d00610069006c00000000004900000014000000001f0000001b00000069006d0061006700650073005c00480078004d00610069006c0053006d0061006c006c00540069006c0065002e0070006e00670000000000000000003100000031535053b1166d44ad8d7048a748402ea43d788c15000000640000000015000000100100000000000000000000390000003153505330f125b7ef471a10a5f102608c9eebac1d0000000a000000001f000000050000004d00610069006c0000000000000000002d00000031535053b377ed0d14c66c45ae5b285b38d7b01b110000000700000000130000000000000000000000000000000000260000001e00efbe0200530079007300740065006d00500069006e006e00650064000000bb05120000002b00efbe48aaba63b19ada01bb05a60000001d00efbe02006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f003800770065006b0079006200330064003800620062007700650021006d006900630072006f0073006f00660074002e00770069006e0064006f00770073006c006900760065002e006d00610069006c000000bb05000000000000" /f | Out-Null
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "Favorites" /t REG_BINARY /d "00560100003a001f80c827341f105c1042aa032ee45287d668260001002600efbe12000000ee082d3cb19ada01de32c463b19ada01de32c463b19ada01140056003100000000009e582c1e10005461736b42617200400009000400efbe9e582c1e9e582c1e2e00000069a10100000001000000000000000000000000000000224753005400610073006b0042006100720000001600c4003200860900009e58241d20004d4943524f537e312e4c4e4b0000560009000400efbe9e582c1e9e582c1e2e0000006aa10100000001000000000000000000000000000000055593004d006900630072006f0073006f0066007400200045006400670065002e006c006e006b0000001c00120000002b00efbede32c463b19ada011c001a0000001d00efbe02004d005300450064006700650000001c00260000001e00efbe0200530079007300740065006d00500069006e006e006500640000001c00000000a40100003a001f80c827341f105c1042aa032ee45287d668260001002600efbe12000000ee082d3cb19ada01de32c463b19ada01aaf6c863b19ada01140056003100000000009e582c1e11005461736b42617200400009000400efbe9e582c1e9e582c1e2e00000069a1010000000100000000000000000000000000000056834e005400610073006b00420061007200000016001201320097010000874f0749200046494c4545587e312e4c4e4b00007c0009000400efbe9e582c1e9e582c1e2e0000006ba10100000001000000000000000000520000000000589c4400460069006c00650020004500780070006c006f007200650072002e006c006e006b00000040007300680065006c006c00330032002e0064006c006c002c002d003200320030003600370000001c00120000002b00efbeaaf6c863b19ada011c00420000001d00efbe02004d006900630072006f0073006f00660074002e00570069006e0064006f00770073002e004500780070006c006f0072006500720000001c00260000001e00efbe0200530079007300740065006d00500069006e006e006500640000001c000000004b06000014001f809bd434424502f34db7803893943456e1350600009905415050538705080003000000000000004e0200003153505355284c9f799f394ba8d0e1d42de1d5f35d00000011000000001f000000250000004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f003800770065006b0079006200330064003800620062007700650000000000110000000e0000000013000000010000008500000015000000001f000000390000004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f00310031003900310030002e0031003000300032002e0035002e0030005f007800360034005f005f003800770065006b00790062003300640038006200620077006500000000006500000005000000001f000000290000004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f003800770065006b00790062003300640038006200620077006500210041007000700000000000bd0000000f000000001f0000005600000043003a005c00500072006f006700720061006d002000460069006c00650073005c00570069006e0064006f007700730041007000700073005c004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f00310031003900310030002e0031003000300032002e0035002e0030005f007800360034005f005f003800770065006b0079006200330064003800620062007700650000001d00000020000000004800000005c572a5af325c4ea556c4940b8a77a1000000008a020000315350534d0bd48669903c44819a2a54090dccec550000000c000000001f000000210000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065004d0065006400540069006c0065002e0070006e006700000000005500000002000000001f000000210000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065004100700070004c006900730074002e0070006e00670000000000590000000f000000001f000000230000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f0072006500420061006400670065004c006f0067006f002e0070006e00670000000000550000000d000000001f000000220000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065005700690064006500540069006c0065002e0070006e0067000000110000000400000000130000000078d7ff5900000013000000001f000000230000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f00720065004c006100720067006500540069006c0065002e0070006e0067000000000011000000050000000013000000ffffffff110000000e0000000013000000a5040000310000000b000000001f000000100000004d006900630072006f0073006f00660074002000530074006f007200650000005900000014000000001f000000230000004100730073006500740073005c00410070007000540069006c00650073005c00530074006f007200650053006d0061006c006c00540069006c0065002e0070006e00670000000000000000003100000031535053b1166d44ad8d7048a748402ea43d788c150000006400000000150000001401000000000000000000004d0000003153505330f125b7ef471a10a5f102608c9eebac310000000a000000001f000000100000004d006900630072006f0073006f00660074002000530074006f00720065000000000000002d00000031535053b377ed0d14c66c45ae5b285b38d7b01b110000000700000000130000000000000000000000000000000000120000002b00efbec858cb63b19ada019f055e0000001d00efbe02004d006900630072006f0073006f00660074002e00570069006e0064006f0077007300530074006f00720065005f003800770065006b00790062003300640038006200620077006500210041007000700000009f05260000001e00efbe0200530079007300740065006d00500069006e006e006500640000009f05000000af06000014001f809bd434424502f34db7803893943456e199060000b50541505053a30508000300000000000000f60200003153505355284c9f799f394ba8d0e1d42de1d5f37500000011000000001f000000320000006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f003800770065006b007900620033006400380062006200770065000000110000000e000000001300000001000000a900000015000000001f0000004b0000006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f00310036003000300035002e00310031003600320039002e00320030003300310036002e0030005f007800360034005f005f003800770065006b0079006200330064003800620062007700650000000000ad00000005000000001f0000004d0000006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f003800770065006b0079006200330064003800620062007700650021006d006900630072006f0073006f00660074002e00770069006e0064006f00770073006c006900760065002e006d00610069006c0000000000e10000000f000000001f0000006800000043003a005c00500072006f006700720061006d002000460069006c00650073005c00570069006e0064006f007700730041007000700073005c006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f00310036003000300035002e00310031003600320039002e00320030003300310036002e0030005f007800360034005f005f003800770065006b0079006200330064003800620062007700650000001d000000200000000048000000a0078866edfc3449881d9db73548d33c0000000012020000315350534d0bd48669903c44819a2a54090dccec490000000c000000001f0000001c00000069006d0061006700650073005c00480078004d00610069006c004d0065006400690075006d00540069006c0065002e0070006e00670000004500000002000000001f0000001900000069006d0061006700650073005c00480078004d00610069006c004100700070004c006900730074002e0070006e00670000000000410000000f000000001f0000001700000069006d0061006700650073005c00480078004d00610069006c00420061006400670065002e0070006e00670000000000450000000d000000001f0000001a00000069006d0061006700650073005c00480078004d00610069006c005700690064006500540069006c0065002e0070006e0067000000110000000400000000130000000078d7ff4900000013000000001f0000001b00000069006d0061006700650073005c00480078004d00610069006c004c006100720067006500540069006c0065002e0070006e0067000000000011000000050000000013000000ffffffff110000000e0000000013000000ad0400001d0000000b000000001f000000050000004d00610069006c00000000004900000014000000001f0000001b00000069006d0061006700650073005c00480078004d00610069006c0053006d0061006c006c00540069006c0065002e0070006e00670000000000000000003100000031535053b1166d44ad8d7048a748402ea43d788c15000000640000000015000000100100000000000000000000390000003153505330f125b7ef471a10a5f102608c9eebac1d0000000a000000001f000000050000004d00610069006c0000000000000000002d00000031535053b377ed0d14c66c45ae5b285b38d7b01b110000000700000000130000000000000000000000000000000000120000002b00efbe48aaba63b19ada01bb05a60000001d00efbe02006d006900630072006f0073006f00660074002e00770069006e0064006f007700730063006f006d006d0075006e00690063006100740069006f006e00730061007000700073005f003800770065006b0079006200330064003800620062007700650021006d006900630072006f0073006f00660074002e00770069006e0064006f00770073006c006900760065002e006d00610069006c000000bb05260000001e00efbe0200530079007300740065006d00500069006e006e00650064000000bb050000ff" /f | Out-Null
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "FavoritesChanges" /t REG_DWORD /d "8" /f | Out-Null
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "FavoritesVersion" /t REG_DWORD /d "3" /f | Out-Null
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Taskband\AuxilliaryPins" /v "MailPin" /t REG_DWORD /d "1" /f | Out-Null
# windows widgets from taskbar
cmd /c "reg delete `"HKLM\SOFTWARE\Policies\Microsoft\Dsh`" /f >nul 2>&1"
# normal taskbar alignment
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced`" /v `"TaskbarAl`" /f >nul 2>&1"
# search from taskbar
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Search`" /v `"SearchboxTaskbarMode`" /f >nul 2>&1"
# task view from taskbar
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced`" /v `"ShowTaskViewButton`" /f >nul 2>&1"
# chat from taskbar
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced`" /v `"TaskbarMn`" /f >nul 2>&1"
# copilot from taskbar
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced`" /v `"ShowCopilotButton`" /f >nul 2>&1"
# news and interests
cmd /c "reg delete `"HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds`" /f >nul 2>&1"
# meet now
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer`" /f >nul 2>&1"
# security taskbar icon
cmd /c "reg add `"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run`" /v `"SecurityHealth`" /t REG_BINARY /d `"040000000000000000000000`" /f >nul 2>&1"
# action center
cmd /c "reg delete `"HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer`" /f >nul 2>&1"
# don't show all taskbar icons w10 only
cmd /c "reg delete `"HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer`" /v `"EnableAutoTray`" /f >nul 2>&1"
# START MENU W11
Remove-Item -Recurse -Force "$env:USERPROFILE\AppData\Local\Packages\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\LocalState\start2.bin" -ErrorAction SilentlyContinue
# START MENU W10
# delete startmenulayout.xml
Remove-Item -Recurse -Force "$env:C:\Windows\StartMenuLayout.xml" -ErrorAction SilentlyContinue | Out-Null
# create startmenulayout.xml
$MultilineComment = @"
<LayoutModificationTemplate xmlns:defaultlayout="http://schemas.microsoft.com/Start/2014/FullDefaultLayout" xmlns:start="http://schemas.microsoft.com/Start/2014/StartLayout" Version="1" xmlns="http://schemas.microsoft.com/Start/2014/LayoutModification">
  <LayoutOptions StartTileGroupCellWidth="6" />
  <DefaultLayoutOverride>
    <StartLayoutCollection>
      <defaultlayout:StartLayout GroupCellWidth="6">
        <start:Group Name="Productivity">
          <start:Folder Name="" Size="2x2" Column="2" Row="0">
            <start:Tile Size="2x2" Column="4" Row="2" AppUserModelID="Microsoft.Office.OneNote_8wekyb3d8bbwe!microsoft.onenoteim" />
            <start:DesktopApplicationTile Size="2x2" Column="0" Row="2" DesktopApplicationLinkPath="%APPDATA%\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" />
            <start:Tile Size="2x2" Column="0" Row="4" AppUserModelID="Microsoft.SkypeApp_kzf8qxf38zg5c!App" />
          </start:Folder>
          <start:Tile Size="2x2" Column="0" Row="0" AppUserModelID="Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe!Microsoft.MicrosoftOfficeHub" />
          <start:DesktopApplicationTile Size="2x2" Column="0" Row="2" DesktopApplicationLinkPath="%ALLUSERSPROFILE%\Microsoft\Windows\Start Menu\Programs\Microsoft Edge.lnk" />
          <start:Tile Size="2x2" Column="4" Row="2" AppUserModelID="7EE7776C.LinkedInforWindows_w1wdnht996qgy!App" />
          <start:Tile Size="2x2" Column="4" Row="0" AppUserModelID="microsoft.windowscommunicationsapps_8wekyb3d8bbwe!Microsoft.WindowsLive.Mail" />
          <start:Tile Size="2x2" Column="2" Row="2" AppUserModelID="Microsoft.Windows.Photos_8wekyb3d8bbwe!App" />
        </start:Group>
        <start:Group Name="Explore">
          <start:Folder Name="Play" Size="2x2" Column="4" Row="2">
            <start:Tile Size="2x2" Column="2" Row="0" AppUserModelID="Microsoft.WindowsCalculator_8wekyb3d8bbwe!App" />
            <start:Tile Size="2x2" Column="0" Row="0" AppUserModelID="Clipchamp.Clipchamp_yxz26nhyzhsrt!App" />
          </start:Folder>
          <start:Tile Size="2x2" Column="4" Row="0" AppUserModelID="Microsoft.Todos_8wekyb3d8bbwe!App" />
          <start:Tile Size="2x2" Column="2" Row="2" AppUserModelID="Microsoft.MicrosoftSolitaireCollection_8wekyb3d8bbwe!App" />
          <start:Tile Size="2x2" Column="2" Row="0" AppUserModelID="SpotifyAB.SpotifyMusic_zpdnekdrzrea0!Spotify" />
          <start:Tile Size="2x2" Column="0" Row="2" AppUserModelID="Microsoft.ZuneVideo_8wekyb3d8bbwe!Microsoft.ZuneVideo" />
          <start:Tile Size="2x2" Column="0" Row="0" AppUserModelID="Microsoft.WindowsStore_8wekyb3d8bbwe!App" />
        </start:Group>
      </defaultlayout:StartLayout>
    </StartLayoutCollection>
  </DefaultLayoutOverride>
</LayoutModificationTemplate>
"@
Set-Content -Path "C:\Windows\StartMenuLayout.xml" -Value $MultilineComment -Force -Encoding ASCII
# assign startmenulayout.xml registry
$layoutFile="C:\Windows\StartMenuLayout.xml"
$regAliases = @("HKLM", "HKCU")
foreach ($regAlias in $regAliases){
$basePath = $regAlias + ":\SOFTWARE\Policies\Microsoft\Windows"
$keyPath = $basePath + "\Explorer"
IF(!(Test-Path -Path $keyPath)) {
New-Item -Path $basePath -Name "Explorer" | Out-Null
}
Set-ItemProperty -Path $keyPath -Name "LockedStartLayout" -Value 1 | Out-Null
Set-ItemProperty -Path $keyPath -Name "StartLayoutFile" -Value $layoutFile | Out-Null
}
# restart explorer
Stop-Process -Force -Name explorer -ErrorAction SilentlyContinue | Out-Null
Timeout /T 5 | Out-Null
# disable lockedstartlayout registry
foreach ($regAlias in $regAliases){
$basePath = $regAlias + ":\SOFTWARE\Policies\Microsoft\Windows"
$keyPath = $basePath + "\Explorer"
Set-ItemProperty -Path $keyPath -Name "LockedStartLayout" -Value 0
}
# restart explorer
Stop-Process -Force -Name explorer -ErrorAction SilentlyContinue | Out-Null
# delete startmenulayout.xml
Remove-Item -Recurse -Force "$env:C:\Windows\StartMenuLayout.xml" -ErrorAction SilentlyContinue | Out-Null
Clear-Host
Write-Host "Restart to apply . . ."
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
exit

      }
    } } else { Write-Host "Invalid input. Please select a valid option (1-2)." } }